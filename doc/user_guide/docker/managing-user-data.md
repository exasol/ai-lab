# Managing User Data

Exasol AI-Lab comes with a set of Jupyter Notebook Files with file extension `.ipynb` demonstrating AI applications on top of the Exasol database.

Additionally the demos in the Exasol AI-Lab require some credentials and other configuration strings which are managed in a [Secure Configuration Storage](secure-configuration-storage.md) (SCS).

By default the AI-Lab will instantiate the notebook files with a predefined content. The predefined content may change with each release of the AI-Lab. However, the AI-Lab won't overwrite existing files.

The SCS on the other hand will be populated by the Exasol AI-Lab including manual input from the user but also entries generated by the Exasol AI-Lab.

The Docker Edition of Exasol AI-Lab allows you to
* Keep your data and changes in these files
* Reuse modified files in future sessions
* Backup and restore the files

## Basics

In order to save your changes persistently, to reuse, backup, and restore them, the AI-Lab
* Keeps the notebook files as well as the SCS in the directory `/root/notebooks` inside the Docker container
* Uses a so-called [_Docker Volume_](https://docs.docker.com/storage/volumes) mounted to `/root/notebooks` to store the content independent of the Docker container

## Additional Environment Variables

Following the general [User Guide for the AI-Lab Docker Edition](docker-usage.md#defining-environment-variables) this document uses some additional environment variables:
* Variable `VOLUME` is expected to contain the name of your Docker volume.
* Variable `DIR` is expected to point to a directory to contain your backup.

Here are some sample values &mdash; please change to your needs:

```shell
VOLUME=my-vol
DIR=~/tmp/backup
```

## Creating a Backup of Your Volume

See also [Back up a volume](https://docs.docker.com/storage/volumes/#back-up-a-volume) in official Docker documentation.

The following Unix shell commands will
* Run a Docker container
* Mount your volume
* Copy the contents of your volume to directory `$DIR`
* Remove the container

To ensure a consistent backup we recommend to stop the AI-Lab Docker container before creating a backup.

```shell
C=$(docker run --detach -v ${VOLUME}:/notebooks ubuntu sleep infinity)
docker cp ${C}:/notebooks ${DIR}
docker rm -f ${C}
unset C
```
## Restoring Your Volume Contents

See also [Restore volume from a backup](https://docs.docker.com/storage/volumes/#restore-volume-from-a-backup) in official Docker documentation.

To ensure consistent results we recommend to stop the AI-Lab Docker container before restoring the volume contents.

The following Unix shell commands will
* Run a Docker container
* Mount your volume
* Copy the contents of directory `$DIR` into your volume
* Remove the container

```shell
C=$(docker run --detach -v ${VOLUME}:/notebooks ubuntu sleep infinity)
docker cp ${DIR}/notebooks ${C}:/
docker rm -f ${C}
unset C
```

## Replacing the Docker Volume

In order to use notebook files of a newer version of the AI-Lab you must use a different Docker volume. Otherwise the newer version will still display the old notebooks contained in your Docker volume.

You can also delete the old volume:
* If you modified some of the files then please consider to make a backup first.
* Docker volumes can only be deleted if there aren't any Docker containers using them.
* Also stopped containers still prevent Docker volumes from being deleted.

Use the following command to find out the ID of existing Docker containers, including the stopped ones, see also [User Guide for AI-Lab Docker edition](docker-usage.md#logging-in-to-the-docker-container):

```shell
docker ps --all
```

The following commands will remove the container with ID `${CONTAINER}` and the volume with the name `${VOLUME}`:

```shell
docker rm -f ${CONTAINER}
docker volume rm -f ${VOLUME}
```